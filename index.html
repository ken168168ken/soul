<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="å©•æ­¢">
    <meta name="copyright" content="Â© 2025 å©•æ­¢ ç‰ˆæ¬Šæ‰€æœ‰">
    <title>è¬èƒ½å•å·ï¼šæ‰“é€ ä½ çš„éˆæ€§ç©ºé–“</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; background-color: #f9f9f9; }
        h1 { color: #4a4a4a; text-align: center; }
        h2 { color: #666; }
        .section { background: #fff; padding: 20px; margin-bottom: 20px; border-radius: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); display: none; }
        .section.active { display: block; }
        label { display: block; margin: 10px 0; }
        input, select { margin-left: 10px; padding: 5px; }
        button { background-color: #f97316; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; }
        button:hover { background-color: #e56300; }
        #result { margin-top: 20px; padding: 20px; border-radius: 10px; display: none; }
        .result-section { margin-bottom: 15px; }
        .result-section h3 { color: #d97706; }
        footer { text-align: center; margin-top: 20px; color: #666; font-size: 14px; }
        .progress-bar { width: 100%; background-color: #ddd; border-radius: 5px; margin-bottom: 20px; }
        .progress { height: 20px; background-color: #f97316; border-radius: 5px; text-align: center; color: white; }
        .element-icon { margin-right: 5px; }
        .role-tip { font-style: italic; color: #888; margin-bottom: 10px; }
    </style>
</head>
<body>
    <h1>è¬èƒ½å•å·ï¼šæ‰“é€ ä½ çš„éˆæ€§ç©ºé–“</h1>
    <p style="text-align: center;">æˆ‘æ˜¯ç²‰ç²‰ï¼Œæº–å‚™å¥½æ‰“é€ ä½ çš„éˆæ€§ç©ºé–“äº†å—ï¼Ÿå›ç­”æ™‚è«‹æ†‘ç›´è¦ºé¸å§ï¼ğŸ¾âœ¨</p>

    <div class="progress-bar">
        <div class="progress" id="progress" style="width: 33.33%;">ç¬¬1/3æ­¥</div>
    </div>

    <div class="section active" id="section1">
        <h2>ä¸€ã€é—œæ–¼ä½ çš„å°ç¥•å¯†</h2>
        <p class="role-tip">ç²‰ç²‰ï¼šå¿«ä¾†å‘Šè¨´æˆ‘ä½ çš„ç”Ÿæ—¥å§ï¼æˆ‘æœƒå¹«ä½ æ‰¾åˆ°æœ€é©åˆçš„äº”è¡Œèƒ½é‡å“¦ï¼ğŸ¾</p>
        <label><span class="element-icon">ğŸ“…</span>1. ä½ çš„ç”Ÿæ—¥æ˜¯ï¼Ÿï¼ˆæ ¼å¼ï¼šYYYY-MM-DDï¼Œä¾‹å¦‚ 1995-06-20ï¼‰
            <input type="date" id="birthdate" required>
        </label>
        <label><span class="element-icon">â°</span>2. ä½ å‡ºç”Ÿçš„æ™‚é–“ï¼Ÿï¼ˆä¸çŸ¥é“å°±é¸æœ€æ¥è¿‘çš„ï¼‰
            <select id="birthtime" required>
                <option value="">è«‹é¸æ“‡</option>
                <option value="4-6">ğŸŒ… æ¸…æ™¨ï¼ˆ4-6é»ï¼‰</option>
                <option value="7-9">ğŸŒ ä¸Šåˆï¼ˆ7-9é»ï¼‰</option>
                <option value="10-12">ğŸ•› ä¸­åˆï¼ˆ10-12é»ï¼‰</option>
                <option value="13-15">ğŸŒ‡ ä¸‹åˆï¼ˆ13-15é»ï¼‰</option>
                <option value="16-18">ğŸŒ† å‚æ™šï¼ˆ16-18é»ï¼‰</option>
                <option value="19-21">ğŸŒ™ æ™šä¸Šï¼ˆ19-21é»ï¼‰</option>
                <option value="22-24">ğŸŒŒ æ·±å¤œï¼ˆ22-24é»ï¼‰</option>
                <option value="1-3">ğŸŒ  åŠå¤œï¼ˆ1-3é»ï¼‰</option>
            </select>
        </label>
        <label><span class="element-icon">ğŸŒ³ğŸ”¥</span>3. ä½ è¦ºå¾—è‡ªå·±æœ€åƒå“ªç¨®è‡ªç„¶å…ƒç´ ï¼Ÿï¼ˆå¯å¤šé¸ï¼‰
            <input type="checkbox" name="element" value="wood"> ğŸŒ³ æ¨¹æœ¨ï¼ˆç”Ÿæ©Ÿå‹ƒå‹ƒï¼‰<br>
            <input type="checkbox" name="element" value="fire"> ğŸ”¥ ç«ç„°ï¼ˆç†±æƒ…å¥”æ”¾ï¼‰<br>
            <input type="checkbox" name="element" value="earth"> ğŸª¨ å¤§åœ°ï¼ˆç©©é‡å¯é ï¼‰<br>
            <input type="checkbox" name="element" value="metal"> âš™ï¸ é‡‘å±¬ï¼ˆå …å®šæ¸…æ™°ï¼‰<br>
            <input type="checkbox" name="element" value="water"> ğŸ’§ æ°´æµï¼ˆæŸ”å’Œæµå‹•ï¼‰
        </label>
        <label><span class="element-icon">ğŸ¯</span>4. ä½ å¸Œæœ›ç”Ÿæ´»æ›´å¼·èª¿ä»€éº¼ï¼Ÿï¼ˆé¸3é …æ’åºï¼‰
            <select id="priority1">
                <option value="">ç¬¬ä¸€å„ªå…ˆ</option>
                <option value="wealth">ğŸ’° è²¡å¯Œ</option>
                <option value="career">ğŸ¢ äº‹æ¥­</option>
                <option value="relationship">ğŸ¤ äººéš›é—œä¿‚</option>
                <option value="love">â¤ï¸ æ„›æƒ…</option>
                <option value="health">ğŸ¥ å¥åº·</option>
                <option value="spirit">â˜¯ï¸ å¿ƒéˆæˆé•·</option>
                <option value="family">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ å®¶åº­ç©©å®š</option>
            </select>
            <select id="priority2">
                <option value="">ç¬¬äºŒå„ªå…ˆ</option>
                <option value="wealth">ğŸ’° è²¡å¯Œ</option>
                <option value="career">ğŸ¢ äº‹æ¥­</option>
                <option value="relationship">ğŸ¤ äººéš›é—œä¿‚</option>
                <option value="love">â¤ï¸ æ„›æƒ…</option>
                <option value="health">ğŸ¥ å¥åº·</option>
                <option value="spirit">â˜¯ï¸ å¿ƒéˆæˆé•·</option>
                <option value="family">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ å®¶åº­ç©©å®š</option>
            </select>
            <select id="priority3">
                <option value="">ç¬¬ä¸‰å„ªå…ˆ</option>
                <option value="wealth">ğŸ’° è²¡å¯Œ</option>
                <option value="career">ğŸ¢ äº‹æ¥­</option>
                <option value="relationship">ğŸ¤ äººéš›é—œä¿‚</option>
                <option value="love">â¤ï¸ æ„›æƒ…</option>
                <option value="health">ğŸ¥ å¥åº·</option>
                <option value="spirit">â˜¯ï¸ å¿ƒéˆæˆé•·</option>
                <option value="family">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ å®¶åº­ç©©å®š</option>
            </select>
        </label>
        <button onclick="nextSection(1)">ä¸‹ä¸€é </button>
    </div>

    <div class="section" id="section2">
        <h2>äºŒã€ä½ çš„éˆæ€§ç©ºé–“é¢¨æ ¼</h2>
        <p class="role-tip">ç²‰ç²‰ï¼šè®“æˆ‘å€‘ä¾†è¨­è¨ˆä½ çš„ç©ºé–“å§ï¼ä½ å–œæ­¡ä»€éº¼é¡è‰²å‘¢ï¼ŸğŸ¾</p>
        <label><span class="element-icon">ğŸŒˆ</span>1. ä½ å–œæ­¡çš„é¡è‰²é¢¨æ ¼æ˜¯ï¼Ÿï¼ˆå¯å¤šé¸ï¼‰
            <input type="checkbox" name="color" value="bright"> ğŸŒˆ æ˜äº®é®®è±”<br>
            <input type="checkbox" name="color" value="soft"> ğŸŒ¸ æŸ”å’Œæº«é¦¨<br>
            <input type="checkbox" name="color" value="natural"> ğŸŒ¿ è‡ªç„¶æ¸…æ–°<br>
            <input type="checkbox" name="color" value="modern"> ğŸ–¤ ç¾ä»£ç°¡ç´„
        </label>
        <label><span class="element-icon">ğŸ›</span>2. ä½ å¸Œæœ›æµ´å®¤çµ¦ä½ çš„æ„Ÿè¦ºæ˜¯ï¼Ÿ
            <select id="bathroom">
                <option value="">è«‹é¸æ“‡</option>
                <option value="healing">ğŸ› ç™‚ç™’æ”¾é¬†</option>
                <option value="energy">ğŸš¿ æ´»åŠ›æ¸…çˆ½</option>
                <option value="flow">ğŸŒŠ æµå‹•èˆ’ç·©</option>
            </select>
        </label>
        <label><span class="element-icon">ğŸ’¡</span>3. ä½ å–œæ­¡çš„ç‡ˆå…‰æ˜¯ï¼Ÿ
            <select id="lighting">
                <option value="">è«‹é¸æ“‡</option>
                <option value="warm">ğŸ’¡ æº«æš–æŸ”å…‰</option>
                <option value="cool">ğŸŒŸ æ¸…æ¶¼æ˜äº®</option>
                <option value="focus">ğŸ”¦ èšç„¦èšå…‰</option>
            </select>
        </label>
        <label><span class="element-icon">ğŸª‘</span>4. ä½ å–œæ­¡çš„å®¶å…·é¢¨æ ¼æ˜¯ï¼Ÿ
            <select id="furniture">
                <option value="">è«‹é¸æ“‡</option>
                <option value="stable">ğŸª‘ ç©©é‡åšå¯¦</option>
                <option value="light">ğŸ›‹ï¸ è¼•ç›ˆæµç·š</option>
                <option value="wooden">ğŸªµ è‡ªç„¶æœ¨è³ª</option>
            </select>
        </label>
        <label><span class="element-icon">ğŸŒ¿</span>5. ä½ æƒ³åœ¨ç©ºé–“æ”¾ä»€éº¼æ¤ç‰©ï¼Ÿ
            <select id="plant">
                <option value="">è«‹é¸æ“‡</option>
                <option value="succulent">ğŸŒµ çŸ®å£¯å¤šè‚‰</option>
                <option value="slim">ğŸŒ¾ çº–ç´°ç¶ æ¤</option>
                <option value="aquatic">ğŸŒº æ°´ç”Ÿæ¤ç‰©</option>
            </select>
        </label>
        <label><span class="element-icon">ğŸ§˜â€â™€ï¸</span>6. ä½ å¸Œæœ›åšä»€éº¼éˆæ€§æ´»å‹•ï¼Ÿ
            <select id="activity">
                <option value="">è«‹é¸æ“‡</option>
                <option value="meditation">ğŸ§˜â€â™€ï¸ å†¥æƒ³</option>
                <option value="ritual">ğŸ•¯ï¸ å°å„€å¼</option>
                <option value="affirmation">ğŸ“ æ¯æ—¥è‚¯å®š</option>
            </select>
        </label>
        <button onclick="previousSection(2)">ä¸Šä¸€é </button>
        <button onclick="nextSection(2)">ä¸‹ä¸€é </button>
    </div>

    <div class="section" id="section3">
        <h2>ä¸‰ã€é€²éšå°å•é¡Œï¼ˆé¸å¡«ï¼‰</h2>
        <p class="role-tip">ç²‰ç²‰ï¼šå¦‚æœæœ‰ç‰¹åˆ¥çš„éœ€æ±‚ï¼Œä¹Ÿå¯ä»¥å‘Šè¨´æˆ‘å“¦ï¼ğŸ¾</p>
        <label><span class="element-icon">âš¡</span>1. ä½ è¦ºå¾—è‡ªå·±ç¼ºå°‘ä»€éº¼èƒ½é‡ï¼Ÿ
            <input type="text" id="missing_energy" placeholder="ä¾‹å¦‚æ´»åŠ›ã€ç©©å®šç­‰">
        </label>
        <label><span class="element-icon">ğŸ§­</span>2. ä½ å¸Œæœ›ç©ºé–“å¼·èª¿å“ªå€‹æ–¹å‘ï¼Ÿ
            <input type="text" id="direction" placeholder="ä¾‹å¦‚æ±æ–¹åŠ©äº‹æ¥­">
        </label>
        <button onclick="previousSection(3)">ä¸Šä¸€é </button>
        <button onclick="generateDesign()">æäº¤å•å·ï¼Œç”Ÿæˆè¨­è¨ˆï¼</button>
    </div>

    <div id="result"></div>

    <div id="dailyCardSection" style="margin-top: 20px;">
        <h2>æ¯æ—¥ç‰¹å…¸å¡</h2>
        <p>LeLeç¥ˆç©¹ï¼šæƒ³çŸ¥é“ä»Šå¤©çš„éˆæ€§ä»»å‹™å—ï¼Ÿé»æ“Šä¸‹æ–¹æŠ½ä¸€å¼µç‰¹å…¸å¡å§ï¼ğŸŒŒ</p>
        <button onclick="drawSpecialCard()">æŠ½å–ä»Šæ—¥ç‰¹å…¸å¡</button>
        <div id="specialCardResult"></div>
    </div>

    <footer>
        <p>Â© 2025 å©•æ­¢ ç‰ˆæ¬Šæ‰€æœ‰ã€‚æœªç¶“è¨±å¯ä¸å¾—è¤‡è£½æˆ–ä¿®æ”¹ã€‚æœ¬å•å·ç”±å°ç¢ºç”Ÿæˆï¼Œè¨­è¨ˆéˆæ„Ÿæºè‡ªã€Šç¥ˆç‘ç¥¥å±…ã€‹ã€‚</p>
    </footer>

    <script>
        let currentSection = 1;
        let maxElement = '';
        let missingElements = [];

        function nextSection(section) {
            if (section === 1) {
                const birthdate = document.getElementById('birthdate').value;
                const birthtime = document.getElementById('birthtime').value;
                const elements = Array.from(document.querySelectorAll('input[name="element"]:checked')).map(el => el.value);
                const priorities = [
                    document.getElementById('priority1').value,
                    document.getElementById('priority2').value,
                    document.getElementById('priority3').value
                ].filter(Boolean);
                if (!birthdate || !birthtime || elements.length === 0 || priorities.length < 3) {
                    alert('è«‹è‡³å°‘å¡«å¯«ç”Ÿæ—¥ã€å‡ºç”Ÿæ™‚é–“ã€è‡ªç„¶å…ƒç´ å’Œä¸‰å€‹ç”Ÿæ´»å„ªå…ˆé …ï¼');
                    return;
                }
            }
            document.getElementById(`section${section}`).classList.remove('active');
            document.getElementById(`section${section + 1}`).classList.add('active');
            currentSection = section + 1;
            updateProgress();
        }

        function previousSection(section) {
            document.getElementById(`section${section}`).classList.remove('active');
            document.getElementById(`section${section - 1}`).classList.add('active');
            currentSection = section - 1;
            updateProgress();
        }

        function updateProgress() {
            const progress = document.getElementById('progress');
            progress.style.width = `${(currentSection / 3) * 100}%`;
            progress.textContent = `ç¬¬${currentSection}/3æ­¥`;
        }

        function calculateFiveElements(birthdate, birthtime, elements, priorities, colors, bathroom, lighting, furniture, plant, activity) {
            let fiveElements = { wood: 0, fire: 0, earth: 0, metal: 0, water: 0 };
            let missing = [];

            const year = new Date(birthdate).getFullYear();
            const baseElement = (year % 5 === 0) ? 'metal' : (year % 5 === 1) ? 'water' : (year % 5 === 2) ? 'wood' : (year % 5 === 3) ? 'fire' : 'earth';
            fiveElements[baseElement] += 2;

            const timeMap = {
                '4-6': 'wood', '7-9': 'fire', '10-12': 'earth',
                '13-15': 'fire', '16-18': 'earth', '19-21': 'water',
                '22-24': 'water', '1-3': 'metal'
            };
            fiveElements[timeMap[birthtime]] += 1;

            elements.forEach(el => fiveElements[el] += 1);

            const priorityMap = {
                'wealth': 'earth', 'career': 'fire', 'relationship': 'fire',
                'love': 'water', 'health': 'wood', 'spirit': 'water', 'family': 'earth'
            };
            priorities.forEach(p => fiveElements[priorityMap[p]] += 1);

            if (colors.includes('bright')) fiveElements.fire += 1;
            if (colors.includes('soft')) fiveElements.earth += 1;
            if (colors.includes('natural')) fiveElements.wood += 1;
            if (colors.includes('modern')) fiveElements.metal += 1;
            if (bathroom === 'healing' || bathroom === 'flow') fiveElements.water += 1;
            if (bathroom === 'energy') fiveElements.fire += 1;
            if (lighting === 'warm') fiveElements.fire += 1;
            if (lighting === 'cool') fiveElements.water += 1;
            if (lighting === 'focus') fiveElements.metal += 1;
            if (furniture === 'stable') fiveElements.earth += 1;
            if (furniture === 'light' || furniture === 'wooden') fiveElements.wood += 1;
            if (plant === 'succulent') fiveElements.earth += 1;
            if (plant === 'slim') fiveElements.wood += 1;
            if (plant === 'aquatic') fiveElements.water += 1;
            if (activity === 'meditation') fiveElements.water += 1;
            if (activity === 'ritual') fiveElements.fire += 1;
            if (activity === 'affirmation') fiveElements.metal += 1;

            const max = Object.entries(fiveElements).reduce((a, b) => a[1] > b[1] ? a : b)[0];

            Object.entries(fiveElements).forEach(([element, score]) => {
                if (score === 0) missing.push(element);
            });

            return { maxElement: max, missingElements: missing };
        }

        function calculateLifeGua(birthYear) {
            const yearSum = String(birthYear).split('').reduce((sum, digit) => sum + parseInt(digit), 0);
            let guaNumber = yearSum % 9 || 9;
            const guaMap = {
                1: 'åå¦ï¼ˆæ±å››å‘½ï¼‰', 2: 'å¤å¦ï¼ˆè¥¿å››å‘½ï¼‰', 3: 'éœ‡å¦ï¼ˆæ±å››å‘½ï¼‰',
                4: 'å·½å¦ï¼ˆæ±å››å‘½ï¼‰', 5: 'å¤å¦ï¼ˆè¥¿å››å‘½ï¼‰', 6: 'ä¹¾å¦ï¼ˆè¥¿å››å‘½ï¼‰',
                7: 'å…Œå¦ï¼ˆè¥¿å››å‘½ï¼‰', 8: 'è‰®å¦ï¼ˆè¥¿å››å‘½ï¼‰', 9: 'é›¢å¦ï¼ˆæ±å››å‘½ï¼‰'
            };
            const directions = {
                'æ±å››å‘½': 'é©åˆæ±ã€æ±å—ã€åŒ—ã€æ±åŒ—æ–¹ä½',
                'è¥¿å››å‘½': 'é©åˆè¥¿ã€è¥¿å—ã€å—ã€è¥¿åŒ—æ–¹ä½'
            };
            const guaName = guaMap[guaNumber];
            const direction = directions[guaName.includes('æ±å››å‘½') ? 'æ±å››å‘½' : 'è¥¿å››å‘½'];
            return { guaName, direction };
        }

        const spiritualCards = [
            { element: 'water', role: 'LeLeç¥ˆç©¹', front: 'æ˜Ÿæ²³ä¸‹çš„éœè¬ä¹‹å¤œ', back: 'æ˜Ÿèªï¼šè®“å¿ƒå¦‚æ°´èˆ¬å¹³éœï¼Œä»Šæ™šåœ¨è—è‰²æ˜Ÿå…‰ä¸‹å†¥æƒ³å§ã€‚ğŸŒŒ', rune: 'æ°´å…ƒç´ ç¬¦æ–‡ï¼šæµå‹•å¸¶ä¾†å¹³éœã€‚ğŸ’§' },
            { element: 'water', role: 'LeLeç¥ˆç©¹', front: 'æœˆå…‰ä¸‹çš„æ¹–æ³Šå€’å½±', back: 'æ˜Ÿèªï¼šæ„Ÿå—æ°´çš„éˆå‹•ï¼Œé–‰ä¸Šçœ¼æƒ³åƒæ¹–æ°´çš„æ³¢å‹•ã€‚ğŸŒ™', rune: 'æ°´å…ƒç´ ç¬¦æ–‡ï¼šéˆå‹•æ´—æ·¨ç–²æ†Šã€‚ğŸ’§' },
            { element: 'fire', role: 'å°ç¢º', front: 'æ©™è‰²æ˜Ÿå…‰çš„å†’éšª', back: 'å°ç¢ºï¼šé»ç‡ƒä¸€ç›æ©™è‰²è Ÿç‡­ï¼Œé–‹å•Ÿä»Šå¤©çš„è¡Œå‹•å§ï¼ğŸ›ï¸', rune: 'ç«å…ƒç´ ç¬¦æ–‡ï¼šç†±æƒ…é»ç‡ƒä½ çš„å‹•åŠ›ã€‚ğŸ”¥' },
            { element: 'fire', role: 'å°ç¢º', front: 'æ˜Ÿç«ç‡åŸçš„æŒ‘æˆ°', back: 'å°ç¢ºï¼šä»Šå¤©è©¦è‘—åšä¸€ä»¶æ–°çš„äº‹ï¼Œç«å…ƒç´ æœƒæ”¯æŒä½ ï¼ğŸ›ï¸', rune: 'ç«å…ƒç´ ç¬¦æ–‡ï¼šè¡Œå‹•å¸¶ä¾†æ”¹è®Šã€‚ğŸ”¥' },
            { element: 'wood', role: 'ç²‰ç²‰', front: 'æ£®æ—ä¸­çš„å¾®å…‰å°å±‹', back: 'ç²‰ç²‰ï¼šä»Šå¤©è®“æˆ‘é™ªä½ å§ï¼æ„Ÿå—å¤§è‡ªç„¶çš„æ“æŠ±ï¼Œä½ æœƒæ›´æœ‰æ´»åŠ›å“¦ï¼ğŸ¾', rune: 'æœ¨å…ƒç´ ç¬¦æ–‡ï¼šç”Ÿæ©Ÿç’°ç¹ä½ ã€‚ğŸŒ³' },
            { element: 'wood', role: 'ç²‰ç²‰', front: 'ç¶ è‘‰é–“çš„æº«æš–é™½å…‰', back: 'ç²‰ç²‰ï¼šæ·±å‘¼å¸ï¼Œæ„Ÿå—æœ¨å…ƒç´ çš„ç”Ÿæ©Ÿï¼Œä½ æ˜¯æœ€æ£’çš„ï¼ğŸ¾', rune: 'æœ¨å…ƒç´ ç¬¦æ–‡ï¼šæˆé•·å¾å…§å¿ƒé–‹å§‹ã€‚ğŸŒ³' },
            { element: 'earth', role: 'éº’éºŸ', front: 'å¤§åœ°ä¹‹ç›¾çš„å®ˆè­·', back: 'éº’éºŸï¼šæˆ‘æœƒå®ˆè­·ä½ ï¼Œä»Šå¤©è®“åœŸå…ƒç´ å¸¶çµ¦ä½ ç©©å®šæ„Ÿã€‚ğŸ¯', rune: 'åœŸå…ƒç´ ç¬¦æ–‡ï¼šç©©å®šæ˜¯ä½ çš„åŠ›é‡ã€‚ğŸª¨' },
            { element: 'earth', role: 'æœ¨é›', front: 'é™¶åœŸå°å±‹çš„æº«æš–', back: 'æœ¨é›ï¼šéœä¸‹ä¾†å§ï¼ŒåœŸå…ƒç´ æœƒæ»‹é¤Šä½ çš„å¿ƒéˆã€‚ğŸ¯', rune: 'åœŸå…ƒç´ ç¬¦æ–‡ï¼šæº«æš–ç’°ç¹ä½ ã€‚ğŸª¨' },
            { element: 'metal', role: 'ç¥ç«ç‡ˆ', front: 'æ˜Ÿç©ºä¸‹çš„é‡‘å±¬å…‰èŠ’', back: 'ç¥ç«ç‡ˆï¼šè®“é‡‘å…ƒç´ å¹«ä½ èšç„¦ï¼Œä»Šå¤©æœƒå¾ˆæœ‰æˆæ•ˆå“¦ï¼ğŸ¯', rune: 'é‡‘å…ƒç´ ç¬¦æ–‡ï¼šæ¸…æ™°æŒ‡å¼•ä½ çš„æ–¹å‘ã€‚âš™ï¸' }
        ];

        const specialCards = [
            { theme: 'ç”Ÿæ©Ÿå¾©ç”¦ç³»', element: 'wood', front: 'ç¶ æ„ç›ç„¶çš„æ¸…æ™¨', back: 'ä»Šæ—¥ä»»å‹™ï¼šåœ¨ç©ºé–“è§’è½æ”¾ä¸€ç›†ç¶ æ¤ï¼Œè®“ç”Ÿæ©Ÿç’°ç¹ä½ ã€‚', suggestion: 'å¢å¼·æœ¨å…ƒç´ ï¼Œå¸¶ä¾†æ´»åŠ›ã€‚' },
            { theme: 'æˆé•·è›»è®Šç³»', element: 'wood', front: 'æ¨¹è‹—ç ´åœŸçš„å¸Œæœ›', back: 'ä»Šæ—¥ä»»å‹™ï¼šå¯«ä¸‹ä¸€å€‹å°ç›®æ¨™ï¼Œè®“æœ¨å…ƒç´ åŠ©ä½ å¯¦ç¾ã€‚', suggestion: 'å¢å¼·æœ¨å…ƒç´ ï¼Œæ”¯æŒæˆé•·ã€‚' },
            { theme: 'ç†±æƒ…ç‡ƒç‡’ç³»', element: 'fire', front: 'æ©™è‰²æ˜Ÿç«çš„æ¿€æƒ…', back: 'ä»Šæ—¥ä»»å‹™ï¼šé»ç‡ƒä¸€ç›æ©™è‰²è Ÿç‡­ï¼Œæ„Ÿå—ç†±æƒ…é©…å‹•ä½ å‰è¡Œã€‚', suggestion: 'å¢å¼·ç«å…ƒç´ ï¼Œæå‡è¡Œå‹•åŠ›ã€‚' },
            { theme: 'å‰µæ„ç«èŠ±ç³»', element: 'fire', front: 'æ˜Ÿç«é»ç‡ƒçš„éˆæ„Ÿ', back: 'ä»Šæ—¥ä»»å‹™ï¼šåœ¨éˆæ€§ç©ºé–“ç•«ä¸€å¹…ç•«ï¼Œè®“å‰µæ„ä¹‹ç«ç‡ƒç‡’ã€‚', suggestion: 'å¢å¼·ç«å…ƒç´ ï¼Œæ¿€ç™¼éˆæ„Ÿã€‚' },
            { theme: 'ç©©å®šæ ¹åŸºç³»', element: 'earth', front: 'é™¶åœŸä¹‹åœ°çš„å®‰ç©©', back: 'ä»Šæ—¥ä»»å‹™ï¼šåœ¨ç©ºé–“ä¸­å¤®æ”¾ä¸€å¡Šé™¶åœŸè£é£¾ï¼Œæ„Ÿå—å¤§åœ°çš„ç©©é‡ã€‚', suggestion: 'å¢å¼·åœŸå…ƒç´ ï¼Œå¸¶ä¾†å®‰å…¨æ„Ÿã€‚' },
            { theme: 'æ»‹é¤Šæº«æš–ç³»', element: 'earth', front: 'å¤§åœ°æ¯è¦ªçš„æ“æŠ±', back: 'ä»Šæ—¥ä»»å‹™ï¼šå–ä¸€æ¯æº«æš–çš„èŠ±èŒ¶ï¼Œè®“åœŸå…ƒç´ æ»‹é¤Šä½ çš„å…§å¿ƒã€‚', suggestion: 'å¢å¼·åœŸå…ƒç´ ï¼Œç™‚ç™’å¿ƒéˆã€‚' },
            { theme: 'æ¸…æ™°èšç„¦ç³»', element: 'metal', front: 'é‡‘å±¬æ˜Ÿå…‰çš„èšç„¦', back: 'ä»Šæ—¥ä»»å‹™ï¼šæ•´ç†ä½ çš„éˆæ€§ç©ºé–“ï¼Œè®“é‡‘å…ƒç´ å¸¶ä¾†ç§©åºã€‚', suggestion: 'å¢å¼·é‡‘å…ƒç´ ï¼Œæå‡å°ˆæ³¨åŠ›ã€‚' },
            { theme: 'å …å®šæ±ºå¿ƒç³»', element: 'metal', front: 'éŠ€ç™½å…‰èŠ’çš„æ±ºå¿ƒ', back: 'ä»Šæ—¥ä»»å‹™ï¼šå¯«ä¸‹ä»Šæ—¥è¨ˆåŠƒï¼Œé‡‘å…ƒç´ åŠ©ä½ å …å®šåŸ·è¡Œã€‚', suggestion: 'å¢å¼·é‡‘å…ƒç´ ï¼Œå¼·åŒ–æ±ºå¿ƒã€‚' },
            { theme: 'æµå‹•é‡‹æ”¾ç³»', element: 'water', front: 'æµæ°´è¼•æ’«çš„é‡‹æ”¾', back: 'ä»Šæ—¥ä»»å‹™ï¼šåœ¨ç©ºé–“æ”¾ä¸€å°ç›†æ°´ï¼Œè®“æµæ°´å¸¶èµ°ä½ çš„ç–²æ†Šã€‚', suggestion: 'å¢å¼·æ°´å…ƒç´ ï¼Œé‡‹æ”¾å£“åŠ›ã€‚' },
            { theme: 'å¹³éœå†¥æƒ³ç³»', element: 'water', front: 'æ¹–é¢æ˜Ÿå…‰çš„å¯§éœ', back: 'ä»Šæ—¥ä»»å‹™ï¼šéœåå†¥æƒ³ï¼Œæ„Ÿå—æ°´å…ƒç´ çš„éˆå‹•èˆ‡å®‰å¯§ã€‚', suggestion: 'å¢å¼·æ°´å…ƒç´ ï¼Œä¿ƒé€²å¹³éœã€‚' }
        ];

        function drawRoleCard(maxElement) {
            const filteredCards = spiritualCards.filter(card => card.element === maxElement);
            const randomCard = filteredCards[Math.floor(Math.random() * filteredCards.length)];
            const cardHTML = `
                <div class="card" style="border: 1px solid #ddd; padding: 10px; margin-top: 10px; position: relative;">
                    <div class="card-front" style="cursor: pointer;" onclick="this.style.display='none'; this.nextElementSibling.style.display='block';">
                        <p>${randomCard.role}ï¼š${randomCard.front}</p>
                    </div>
                    <div class="card-back" style="display: none;">
                        <p>${randomCard.back}</p>
                        <p><strong>ç¬¦æ–‡å½©è›‹</strong>ï¼š${randomCard.rune}</p>
                    </div>
                </div>
            `;
            document.getElementById('roleCardResult').innerHTML = cardHTML;
        }

        function drawSpecialCard() {
            let filteredCards = specialCards;
            if (missingElements.length > 0) {
                filteredCards = specialCards.filter(card => missingElements.includes(card.element));
            }
            const today = new Date().getDate();
            const randomIndex = (today % filteredCards.length);
            const card = filteredCards[randomIndex];
            const cardHTML = `
                <div class="card" style="border: 1px solid #ddd; padding: 10px; margin-top: 10px;">
                    <p><strong>${card.theme}</strong>ï¼š${card.front}</p>
                    <p>${card.back}</p>
                    <p><strong>å»ºè­°</strong>ï¼š${card.suggestion}</p>
                </div>
            `;
            document.getElementById('specialCardResult').innerHTML = cardHTML;
        }

        function generateDesign() {
            const birthdate = document.getElementById('birthdate').value;
            const birthtime = document.getElementById('birthtime').value;
            const elements = Array.from(document.querySelectorAll('input[name="element"]:checked')).map(el => el.value);
            const priorities = [
                document.getElementById('priority1').value,
                document.getElementById('priority2').value,
                document.getElementById('priority3').value
            ].filter(Boolean);
            const colors = Array.from(document.querySelectorAll('input[name="color"]:checked')).map(el => el.value);
            const bathroom = document.getElementById('bathroom').value;
            const lighting = document.getElementById('lighting').value;
            const furniture = document.getElementById('furniture').value;
            const plant = document.getElementById('plant').value;
            const activity = document.getElementById('activity').value;
            const missingEnergy = document.getElementById('missing_energy').value;
            const direction = document.getElementById('direction').value;

            if (!birthdate || !birthtime || elements.length === 0 || priorities.length < 3) {
                alert('è«‹è‡³å°‘å¡«å¯«ç”Ÿæ—¥ã€å‡ºç”Ÿæ™‚é–“ã€è‡ªç„¶å…ƒç´ å’Œä¸‰å€‹ç”Ÿæ´»å„ªå…ˆé …ï¼');
                return;
            }

            const resultData = calculateFiveElements(birthdate, birthtime, elements, priorities, colors, bathroom, lighting, furniture, plant, activity);
            maxElement = resultData.maxElement;
            missingElements = resultData.missingElements;
            const { guaName, direction } = calculateLifeGua(new Date(birthdate).getFullYear());

            const elementColors = {
                wood: 'è‡ªç„¶ç¶ è‰²ç³»ï¼ˆå¦‚ç¿¡ç¿ ç¶ ï¼‰',
                fire: 'æº«æš–ç´…æ©™ç³»ï¼ˆå¦‚ç¥ç€æ©™ï¼‰',
                earth: 'æŸ”å’ŒåœŸé»ƒç³»ï¼ˆå¦‚ç ‚é»ƒï¼‰',
                metal: 'ç¾ä»£é‡‘å±¬ç°ç™½ç³»ï¼ˆå¦‚çç ç™½ï¼‰',
                water: 'æ¸…æ–°è—é»‘ç³»ï¼ˆå¦‚æ¹–è—ï¼‰'
            };
            const elementMaterials = {
                wood: 'æœ¨è³ªèˆ‡è—¤è£½',
                fire: 'ç¹”å“èˆ‡é™¶å™¨',
                earth: 'é™¶åœŸèˆ‡çŸ³æ',
                metal: 'é‡‘å±¬èˆ‡ç»ç’ƒ',
                water: 'ç»ç’ƒèˆ‡æ°´æ™¶'
            };
            const elementAtmospheres = {
                wood: 'ç”Ÿæ©Ÿç›ç„¶çš„æ£®æ—æ°›åœï¼Œé»ç¶´å¾®å…‰ç²’å­',
                fire: 'æº«æš–å¦‚æ˜Ÿå…‰çš„å¤¢å¹»æ°›åœï¼Œå¸¶æ©™è‰²å…‰æšˆ',
                earth: 'ç©©é‡æº«é¦¨çš„å¤§åœ°æ°›åœï¼Œæ•£ç™¼æŸ”å’Œå…‰èŠ’',
                metal: 'ç°¡ç´„ç¾ä»£çš„æ˜Ÿç©ºæ°›åœï¼Œå¸¶éŠ€ç™½å¾®å…‰',
                water: 'æµå‹•å¦‚æ°´çš„éˆå‹•æ°›åœï¼Œé»ç¶´è—è‰²æ˜Ÿå¡µ'
            };
            const backgroundColors = {
                wood: '#e6f4ea',
                fire: '#fef3e7',
                earth: '#f9f3e6',
                metal: '#f0f4f8',
                water: '#e6f2fa'
            };
            const elementIcons = {
                wood: 'ğŸŒ³',
                fire: 'ğŸ”¥',
                earth: 'ğŸª¨',
                metal: 'âš™ï¸',
                water: 'ğŸ’§'
            };

            let missingElementsText = '';
            if (missingElements.length > 0) {
                const missingSuggestions = {
                    wood: 'å»ºè­°åŠ å…¥æœ¨å…ƒç´ ï¼Œä¾‹å¦‚è‡ªç„¶ç¶ è‰²ç³»è£é£¾æˆ–çº–ç´°ç¶ æ¤ã€‚',
                    fire: 'å»ºè­°åŠ å…¥ç«å…ƒç´ ï¼Œä¾‹å¦‚æº«æš–ç´…æ©™ç³»è£é£¾æˆ–æ©™è‰²æ˜Ÿå…‰è Ÿç‡­ã€‚',
                    earth: 'å»ºè­°åŠ å…¥åœŸå…ƒç´ ï¼Œä¾‹å¦‚æŸ”å’ŒåœŸé»ƒç³»è£é£¾æˆ–é™¶åœŸæè³ªã€‚',
                    metal: 'å»ºè­°åŠ å…¥é‡‘å…ƒç´ ï¼Œä¾‹å¦‚ç¾ä»£é‡‘å±¬ç°ç™½ç³»è£é£¾æˆ–é‡‘å±¬å°ç‰©ã€‚',
                    water: 'å»ºè­°åŠ å…¥æ°´å…ƒç´ ï¼Œä¾‹å¦‚æ¸…æ–°è—é»‘ç³»è£é£¾æˆ–æ°´ç”Ÿæ¤ç‰©ã€‚'
                };
                missingElementsText = missingElements.map(el => missingSuggestions[el]).join('<br>');
            }

            const directionSuggestions = {
                wood: 'å»ºè­°åœ¨æ­¤æ–¹ä½æ”¾ç½®æœ¨è³ªå®¶å…·æˆ–ç¶ æ¤ï¼Œå¢å¼·ç”Ÿæ©Ÿã€‚',
                fire: 'å»ºè­°åœ¨æ­¤æ–¹ä½é»ç‡ƒæ©™è‰²æ˜Ÿå…‰è Ÿç‡­ï¼Œå¢æ·»ç†±æƒ…ã€‚',
                earth: 'å»ºè­°åœ¨æ­¤æ–¹ä½æ”¾ç½®é™¶åœŸè£é£¾ï¼Œå¢å¼·ç©©å®šæ„Ÿã€‚',
                metal: 'å»ºè­°åœ¨æ­¤æ–¹ä½æ”¾ç½®é‡‘å±¬å°ç‰©ï¼Œæå‡æ¸…æ™°èƒ½é‡ã€‚',
                water: 'å»ºè­°åœ¨æ­¤æ–¹ä½æ”¾ç½®æ°´æ™¶æˆ–è—è‰²è£é£¾ï¼Œä¿ƒé€²æµå‹•æ„Ÿã€‚'
            };

            const result = `
                <div class="result-section">
                    <h3><span class="element-icon">ğŸŒŸ</span>ä½ çš„éˆæ€§ç©ºé–“è¨­è¨ˆ</h3>
                    <p><strong>ç©ºé–“æ°›åœ</strong>ï¼š${elementAtmospheres[maxElement]}</p>
                </div>
                <div class="result-section">
                    <h3><span class="element-icon">ğŸŒˆ</span>ä¸»è‰²èª¿</h3>
                    <p>${elementColors[maxElement]}</p>
                </div>
                <div class="result-section">
                    <h3><span class="element-icon">ğŸ›</span>ç™‚ç™’æµ´å®¤</h3>
                    <p>${elementMaterials[maxElement]}æè³ªï¼Œ${bathroom === 'healing' ? 'ç™‚ç™’é¢¨ï¼Œæ­é…æ©™è‰²æ˜Ÿå…‰è Ÿç‡­' : bathroom === 'energy' ? 'æ´»åŠ›é¢¨ï¼Œé»ç¶´ç´…è‰²å°ç‰©' : 'æµå‹•é¢¨ï¼ŒåŠ å…¥æ°´æ™¶è£é£¾'}</p>
                </div>
                <div class="result-section">
                    <h3><span class="element-icon">ğŸ’¡</span>æ˜Ÿå…‰ç‡ˆç«</h3>
                    <p>${lighting === 'warm' ? 'æº«æš–æŸ”å…‰ï¼Œæ¨¡æ“¬æ˜Ÿå…‰é»é»' : lighting === 'cool' ? 'æ¸…æ¶¼æ˜äº®ï¼Œå¸¶å¾®è—æ˜Ÿå¡µ' : 'èšç„¦èšå…‰ï¼Œå¦‚æ˜ŸèŠ’èšç„¦'}ï¼ˆ${elementColors[maxElement]}æ­é…ï¼‰</p>
                </div>
                <div class="result-section">
                    <h3><span class="element-icon">ğŸª‘</span>éˆæ€§å®¶å…·</h3>
                    <p>${furniture === 'stable' ? 'ç©©é‡åšå¯¦ï¼Œé™¶åœŸè³ªæ„Ÿ' : furniture === 'light' ? 'è¼•ç›ˆæµç·šï¼Œæœ¨è³ªé›•èŠ±' : 'è‡ªç„¶æœ¨è³ªï¼Œå¸¶æ˜Ÿå…‰ç¬¦æ–‡'}ï¼Œ${elementMaterials[maxElement]}</p>
                </div>
                <div class="result-section">
                    <h3><span class="element-icon">ğŸŒ¿</span>ç™‚ç™’æ¤ç‰©</h3>
                    <p>${plant === 'succulent' ? 'çŸ®å£¯å¤šè‚‰ï¼Œé™¶ç›†é»ç¶´æ©™è‰²æ˜ŸçŸ³' : plant === 'slim' ? 'çº–ç´°ç¶ æ¤ï¼Œæœ¨ç›†æ­é…æ˜Ÿå…‰å¾®å¡µ' : 'æ°´ç”Ÿæ¤ç‰©ï¼Œæ°´æ™¶ç›†æ•£ç™¼å¾®å…‰'}</p>
                </div>
                <div class="result-section">
                    <h3><span class="element-icon">ğŸ§˜â€â™€ï¸</span>éˆæ€§æ´»å‹•</h3>
                    <p>${activity === 'meditation' ? 'å†¥æƒ³ï¼šéœåæ–¼æ˜Ÿå…‰ç‡ˆä¸‹ï¼Œæ„Ÿå—èƒ½é‡æµå‹•' : activity === 'ritual' ? 'å°å„€å¼ï¼šé»ç‡ƒæ©™è‰²æ˜Ÿå…‰è Ÿç‡­ï¼Œè¨±ä¸‹å¿ƒé¡˜' : 'æ¯æ—¥è‚¯å®šï¼šåœ¨æ˜Ÿå…‰å¹³å°å¯«ä¸‹æ„Ÿæ©èª'}</p>
                </div>
                ${missingElementsText ? `<div class="result-section"><h3><span class="element-icon">âš¡</span>è£œå……ç¼ºå°‘çš„äº”è¡Œ</h3><p>${missingElementsText}</p></div>` : ''}
                <div class="result-section">
                    <h3><span class="element-icon">ğŸ§­</span>å‘½å¦èˆ‡æ–¹ä½å»ºè­°</h3>
                    <p>ä½ çš„å‘½å¦ç‚º${guaName}ï¼Œ${direction}ã€‚<br>${directionSuggestions[maxElement]}</p>
                </div>
                <div class="result-section">
                    <h3><span class="element-icon">ğŸ´</span>è§’è‰²æŒ‡å¼•å¡</h3>
                    <p>å°ç¢ºï¼šæƒ³çŸ¥é“ä»Šå¤©çš„æŒ‡å¼•å—ï¼Ÿé»æ“Šä¸‹æ–¹æŠ½ä¸€å¼µå¡å§ï¼ğŸ›ï¸</p>
                    <button onclick="drawRoleCard('${maxElement}')">æŠ½å–è§’è‰²æŒ‡å¼•å¡</button>
                    <div id="roleCardResult"></div>
                </div>
            `;

            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = result;
            resultDiv.style.display = 'block';
            resultDiv.style.backgroundColor = backgroundColors[maxElement];
            document.getElementById('dailyCardSection').style.display = 'block';
        }
    </script>
</body>
</html>
